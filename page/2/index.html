<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="益达的博客">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="益达的博客">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="益达的博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/">





  <title>益达的博客</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">益达的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/09/21/分析/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yida">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="益达的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/09/21/分析/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-09-21T13:21:27+08:00">
                2018-09-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>基础设计模式的考点：</p>
<p>单例的弊端：<br>1.一个类只被实例化一次，提供了对唯一实例的受控访问<br>2.节省系统资源<br>3.允许可变数目的实例</p>
<p>缺点：<br>一个类只有一个对象，可能造成责任过重，在一定程度上违背了单一职责的原则<br>由于单例模式中没有抽象层，因此单例类的扩展有很大的困难<br>滥用单例将带来一些负面问题，如为了节省资源将数据连接池对象设计为单例。</p>
<p>1、dSYM你是如何分析的<br>方法1 使用XCode<br>这种方法可能是最容易的方法了。</p>
<p>要使用Xcode符号化 crash log，你需要下面所列的3个文件：<br>crash报告（.crash文件）<br>符号文件 (.dsymb文件)<br>应用程序文件 (appName.app文件，把IPA文件后缀改为zip，然后解压，Payload目录下的appName.app文件), 这里的appName是你的应用程序的名称。<br>把这3个文件放到同一个目录下，打开Xcode的Window菜单下的organizer，然后点击Devices tab，然后选中左边的Device Logs。<br>然后把.crash文件拖到Device Logs或者选择下面的import导入.crash文件。<br>这样你就可以看到crash的详细log了。<br>方法2 使用命令行工具symbolicatecrash<br>有时候Xcode不能够很好的符号化crash文件。我们这里介绍如何通过symbolicatecrash来手动符号化crash log。<br>在处理之前，请依然将“.app“, “.dSYM”和 “.crash”文件放到同一个目录下。现在打开终端(Terminal)然后输入如下的命令：<br>export DEVELOPER_DIR=/Applications/Xcode.app/Contents/Developer<br>然后输入命令：<br>/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/Library/PrivateFrameworks/DTDeviceKitBase.framework/Versions/A/Resources/symbolicatecrash appName.crash appName.app &gt; appName.log<br>现在，符号化的crash log就保存在appName.log中了。<br>方法3 使用命令行工具atos<br>如果你有多个“.ipa”文件，多个”.dSYMB”文件，你并不太确定到底“dSYMB”文件对应哪个”.ipa”文件，那么，这个方法就非常适合你。<br>特别当你的应用发布到多个渠道的时候，你需要对不同渠道的crash文件，写一个自动化的分析脚本的时候，这个方法就极其有用。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/08/06/iOS启动优化/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yida">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="益达的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/06/iOS启动优化/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-08-06T23:58:51+08:00">
                2018-08-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>iOS启动优化</p>
<p>App启动过程：</p>
<p>①解析Info.plist<br>加载相关信息，例如闪屏<br>沙箱建立、权限检查<br>②Mach-O加载<br>如果是胖二进制文件，寻找合适当前CPU架构的部分<br>加载所有依赖的Mach-O文件（递归调用Mach-O加载的方法）<br>定位内部、外部指针引用，例如字符串、函数等<br>执行声明为<strong>attribute</strong>((constructor))的C函数<br>加载类扩展（Category）中的方法<br>C++静态对象加载、调用ObjC的 +load 函数<br>③程序执行<br>调用main()<br>调用UIApplicationMain()<br>调用applicationWillFinishLaunching</p>
<p>App启动，系统首先加载可执行文件（自身App的所有.o文件的集合）<br>加载动态连接器dyld，dyld专门用来加载动态链接库的库，执行从dyld开始，dyld从可执行文件的依赖开始，递归加载所有的依赖动态链接库（动态链接库，framework，加载OCruntime的libobjc,系统级别的libSystem，）</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/29/关于Vue生成新的VirtualDOM/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yida">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="益达的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/29/关于Vue生成新的VirtualDOM/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-07-29T23:11:19+08:00">
                2018-07-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>关于VUE切换成virtual dom的树的流程</p>
<p>简单举例子：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">const demo = new Vue(&#123;</span><br><span class="line">	data: &#123;</span><br><span class="line">    	text:"before",</span><br><span class="line">    &#125;</span><br><span class="line">    render(h) &#123;</span><br><span class="line">    	return h('div',&#123;&#125;,[</span><br><span class="line">        	h('span',&#123;&#125;,[this.__toString__(this.text)])</span><br><span class="line">        ])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">setTimeout(function()&#123;</span><br><span class="line">	demo.text = "afer"</span><br><span class="line">&#125;,3000)</span><br></pre></td></tr></table></figure></p>
<p>对应的虚拟dom的变化;;before-&gt;after的变化<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>before<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>after<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>监听data下的所有属性的变化,data的属性变化，如何触发对应的函数；；<br>ES5提供了新的方法，Object.defineProperty。根据这个方法，可以自定getter和setter函数，那么在获取对象属性后设置对象属性就能直接执行响应的回调函数；；</p>
<p>语法Object.defineProperty方法会直接定义在一个新的属性上，或者修改一个对象的现有属性，并返回这个对象。<br>Object.defineProperty(obj,prop,description);<br>obj定义对象的属性；；prop 定义或者修改的属性  description 被定义和描述</p>
<p>底层Vue类的定义：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">class Vue &#123;</span><br><span class="line">  constructor(options) &#123;</span><br><span class="line">    this.$options = options</span><br><span class="line">    this._data = options.data</span><br><span class="line">    observer(options.data, this._update.bind(this))</span><br><span class="line">    this._update()</span><br><span class="line">  &#125;</span><br><span class="line">  _update()&#123;</span><br><span class="line">    this.$options.render()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function observer(obj, cb) &#123;</span><br><span class="line">  Object.keys(obj).forEach((key) =&gt; &#123;</span><br><span class="line">    defineReactive(obj, key, obj[key], cb)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">改造后的方案：</span><br><span class="line">function observer(obj, cb) &#123;</span><br><span class="line">  Object.keys(obj).forEach((key) =&gt; &#123;</span><br><span class="line">  	if(typeof obj[key] === 'object') &#123;</span><br><span class="line">    	new obser</span><br><span class="line">    &#125;</span><br><span class="line">    defineReactive(obj, key, obj[key], cb)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">function defineReactive(obj, key, val, cb) &#123;</span><br><span class="line">  Object.defineProperty(obj, key, &#123;</span><br><span class="line">    enumerable: true,</span><br><span class="line">    configurable: true,</span><br><span class="line">    get: () =&gt; &#123;</span><br><span class="line">      console.log('你访问了' + key)</span><br><span class="line">      return val</span><br><span class="line">    &#125;,</span><br><span class="line">    set: newVal =&gt; &#123;</span><br><span class="line">      if (newVal === val)</span><br><span class="line">        return</span><br><span class="line">      console.log('你设置了' + key)</span><br><span class="line">      console.log('新的' + key + ' = ' + newVal)</span><br><span class="line">      val = newVal</span><br><span class="line">      cb()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var demo1 = new Vue(&#123;</span><br><span class="line">  el: '#demo',</span><br><span class="line">  data: &#123;</span><br><span class="line">    text: "before"</span><br><span class="line">  &#125;,</span><br><span class="line">  render()&#123;</span><br><span class="line">    console.log("我要render了")</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">var demo2 = new Vue(&#123;</span><br><span class="line">	el:'#demo2',</span><br><span class="line">    data: &#123;</span><br><span class="line">    	text: 'before',</span><br><span class="line">        o: &#123;</span><br><span class="line">        	text:'o-before'</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    render() &#123;</span><br><span class="line">    	console.log('我要render')</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>添加代理<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">_proxy(key) &#123;</span><br><span class="line">  const self = this</span><br><span class="line">  Object.defineProperty(self, key, &#123;</span><br><span class="line">    configurable: true,</span><br><span class="line">    enumerable: true,</span><br><span class="line">    get: function proxyGetter() &#123;</span><br><span class="line">      return self._data[key]</span><br><span class="line">    &#125;,</span><br><span class="line">    set: function proxySetter(val) &#123;</span><br><span class="line">      self._data[key] = val</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">在构造函数中添加如下代码</span><br><span class="line"></span><br><span class="line">Object.keys(options.data).forEach(key =&gt; this._proxy(key))</span><br></pre></td></tr></table></figure></p>
<h4 id="转换响应式工作完工"><a href="#转换响应式工作完工" class="headerlink" title="转换响应式工作完工"></a>转换响应式工作完工</h4><ol>
<li>只要 data 的属性发生变化，就会触发 render 函数</li>
<li>这也是为什么只有 data 中的属性是响应式的，而其他地方声明的值不是的原因</li>
</ol>
<p>但是这里有个问题 ？即触发 render 函数的准确度问题？</p>
<h3 id="第二步-解决准确度问题，引出虚拟dom"><a href="#第二步-解决准确度问题，引出虚拟dom" class="headerlink" title="第二步,解决准确度问题，引出虚拟dom"></a>第二步,解决准确度问题，引出虚拟dom</h3><p>思考下边的 demo<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">new Vue(&#123;</span><br><span class="line">  template: `</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>name:<span class="tag">&lt;/<span class="name">span</span>&gt;</span> &#123; &#123;name&#125; &#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>`,</span><br><span class="line">  data: &#123;</span><br><span class="line">    name: 'js',</span><br><span class="line">    age: 24</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">setTimeout(function()&#123;</span><br><span class="line">  demo.age = 25</span><br><span class="line">&#125;, 3000)</span><br></pre></td></tr></table></figure></p>
<h3 id="引入虚拟demo"><a href="#引入虚拟demo" class="headerlink" title="引入虚拟demo"></a>引入虚拟demo</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">vue的两种写法</span><br><span class="line">// template模板写法（最常用的）</span><br><span class="line">new Vue(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    text: "before",</span><br><span class="line">  &#125;,</span><br><span class="line">  template: `</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>text:<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span>`</span><br><span class="line">&#125;)</span><br><span class="line">// render函数写法，类似react的jsx写法</span><br><span class="line">new Vue(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    text: "before",</span><br><span class="line">  &#125;,</span><br><span class="line">  render (h) &#123;</span><br><span class="line">    return (</span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>text:<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">转化成下面的格式</span><br><span class="line">new Vue(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    text: "before",</span><br><span class="line">  &#125;,</span><br><span class="line">  render()&#123;</span><br><span class="line">    return this.__h__('div', &#123;&#125;, [</span><br><span class="line">      this.__h__('span', &#123;&#125;, [this.__toString__(this.text)])</span><br><span class="line">    ])</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">虚拟dom的生成</span><br><span class="line">new Vue(&#123;</span><br><span class="line">  data: &#123;</span><br><span class="line">    text: "before",</span><br><span class="line">  &#125;,</span><br><span class="line">  render()&#123;</span><br><span class="line">    return this.__h__('div', &#123;&#125;, [</span><br><span class="line">      this.__h__('span', &#123;&#125;, [this.__toString__(this.text)])</span><br><span class="line">    ])</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">function VNode(tag, data, children, text) &#123;</span><br><span class="line">  return &#123;</span><br><span class="line">    tag: tag,</span><br><span class="line">    data: data,</span><br><span class="line">    children: children,</span><br><span class="line">    text: text</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Vue &#123;</span><br><span class="line">  constructor(options) &#123;</span><br><span class="line">    this.$options = options</span><br><span class="line">    const vdom = this._update()</span><br><span class="line">    console.log(vdom)</span><br><span class="line">  &#125;</span><br><span class="line">  _update() &#123;</span><br><span class="line">    return this._render.call(this)</span><br><span class="line">  &#125;</span><br><span class="line">  _render() &#123;</span><br><span class="line">    const vnode = this.$options.render.call(this)</span><br><span class="line">    return vnode</span><br><span class="line">  &#125;</span><br><span class="line">  __h__(tag, attr, children) &#123;</span><br><span class="line">    return VNode(tag, attr, children.map((child)=&gt;&#123;</span><br><span class="line">      if(typeof child === 'string')&#123;</span><br><span class="line">        return VNode(undefined, undefined, undefined, child)</span><br><span class="line">      &#125;else&#123;</span><br><span class="line">        return child</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;))</span><br><span class="line">  &#125;</span><br><span class="line">  __toString__(val) &#123;</span><br><span class="line">    return val == null ? '' : typeof val === 'object' ? JSON.stringify(val, null, 2) : String(val);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>回头看问题<br>我们需要知道 render 函数中依赖了 data 中的哪些属性，只有这些属性变化，才需要去触发 render 函数</p>
<h3 id="第三步，依赖收集，准确渲染"><a href="#第三步，依赖收集，准确渲染" class="headerlink" title="第三步，依赖收集，准确渲染"></a>第三步，依赖收集，准确渲染</h3><p>思路： 在这之前，我们已经把 data 中的属性改成响应式了，当去获取或者修改这些变量时便能够触发相应函数。那这里就可以利用这个相应的函数做些手脚了。<br>当声明一个 vue 对象时，在执行 render 函数获取虚拟dom的这个过程中，已经对 render 中依赖的 data 属性进行了一次获取操作，这次获取操作便可以拿到所有依赖。<br>其实不仅是 render，任何一个变量的改别，是因为别的变量改变引起(观察者模式)，都可以用上述方法，也就是 computed 和 watch 的原理</p>
<p>依赖收集<br>首先需要写一个依赖收集的类，每一个data中的属性都有可能被依赖，因此每个属性在响应式转化(defineReactive)的时候，就初始化它。<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">class Dep &#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    this.subs = []</span><br><span class="line">  &#125;</span><br><span class="line">  add(cb) &#123;</span><br><span class="line">    this.subs.push(cb)</span><br><span class="line">  &#125;</span><br><span class="line">  notify() &#123;</span><br><span class="line">    console.log(this.subs)</span><br><span class="line">    this.subs.forEach((cb) =&gt; cb())</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function defineReactive(obj, key, val, cb) &#123;</span><br><span class="line">  const dep = new Dep()</span><br><span class="line">  Object.defineProperty(obj, key, &#123;</span><br><span class="line">    // 省略</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line">class Dep &#123;</span><br><span class="line">  constructor() &#123;</span><br><span class="line">    this.subs = []</span><br><span class="line">  &#125;</span><br><span class="line">  add(cb) &#123;</span><br><span class="line">    this.subs.push(cb)</span><br><span class="line">  &#125;</span><br><span class="line">  notify() &#123;</span><br><span class="line">    console.log(this.subs)</span><br><span class="line">    this.subs.forEach((cb) =&gt; cb())</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p>执行过程<br>当执行render函数的时候，依赖到的变量的get就会被执行，然后就把这个 render函数加到subs里面去。<br>当set的时候,就执行notify，将所有的subs数组里的函数执行，其中就包含render的执行。<br>代码中有一个Dep.target值，这个值时用来区分是普通的get还是收集依赖时的get<br>完整代码： <a href="https://github.com/SirM2z/assets/blob/master/vue-demo.js" target="_blank" rel="noopener">https://github.com/SirM2z/assets/blob/master/vue-demo.js</a></p>
<p>vue react响应式简单对比<br>综上发现： 用Object.defineProperty这个特性可以精确的写出订阅发布模式，从这点来说，vue是优于react的，在没经过优化之前，vue的渲染机制一定是比react更加准确的，为了验证这一说法，我用两个框架同时写了两个相同的简单项目进行对比。</p>
<p>没有对比就没有伤害<br>react项目地址：<a href="http://sirm2z.github.io/react-vue-test/react/index.html" target="_blank" rel="noopener">http://sirm2z.github.io/react-vue-test/react/index.html</a><br>vue项目地址：<a href="http://sirm2z.github.io/react-vue-test/vue/index.html" target="_blank" rel="noopener">http://sirm2z.github.io/react-vue-test/vue/index.html</a><br>通过对比发现，react 在正常使用的过程中产生了多余的渲染，在移动端或者组件嵌套非常深的情况下会产生非常大的性能消耗，因此在使用 react 的过程中，写好 react 生命周期中的 shouldComponentUpdate 是非常重要的！</p>
<p>所有资源<br>完整代码： <a href="https://github.com/SirM2z/assets/blob/master/vue-demo.js" target="_blank" rel="noopener">https://github.com/SirM2z/assets/blob/master/vue-demo.js</a><br>PPT网址： <a href="http://sirm2z.github.io/vue-demo-ppt/index.html" target="_blank" rel="noopener">http://sirm2z.github.io/vue-demo-ppt/index.html</a><br>博客文章网址： <a href="http://www.jianshu.com/p/7374c4e91891" target="_blank" rel="noopener">http://www.jianshu.com/p/7374c4e91891</a><br>react项目地址： <a href="http://sirm2z.github.io/react-vue-test/react/index.html" target="_blank" rel="noopener">http://sirm2z.github.io/react-vue-test/react/index.html</a><br>vue项目地址： <a href="http://sirm2z.github.io/react-vue-test/vue/index.html" target="_blank" rel="noopener">http://sirm2z.github.io/react-vue-test/vue/index.html</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/09/iOS综合总结/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yida">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="益达的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/09/iOS综合总结/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-07-09T09:32:32+08:00">
                2018-07-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>图示话总结：</p>
<p><a href="https://mp.weixin.qq.com/s/snxHumanNb-BLUkweMxe6Q" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/snxHumanNb-BLUkweMxe6Q</a></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/foPACGrddJ2IMNAbgJ9cv70VpzqEy0tZGDKp3lPAEQxSez7S4nTJuTLAZFAlQz9rAjetvtiawgwfSBk798UCUtQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt=""></p>
<p>runtime：<br><img src="https://mmbiz.qpic.cn/mmbiz_png/foPACGrddJ2IMNAbgJ9cv70VpzqEy0tZNbhP7NCGh0dVqLFNkloj7MdVSKmExjV0LV4FKZicO7MoaYcwcgUOjicQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt=""></p>
<p>内存管理：<br><img src="https://mmbiz.qpic.cn/mmbiz_png/foPACGrddJ2IMNAbgJ9cv70VpzqEy0tZU6gm0pyTEvD0YvuEia0qIDz7pzPwZMEVgd6vwJTIEJzGq2Pz5Q5J32g/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt=""></p>
<p>Block<br><img src="https://mmbiz.qpic.cn/mmbiz_png/foPACGrddJ2IMNAbgJ9cv70VpzqEy0tZmJmBoZ4B3tcH3XUxibVl9wGC60WvqyMxMniblq2bJKKroicjDRBt0QIFw/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt=""></p>
<p>多线程：<br><img src="https://mmbiz.qpic.cn/mmbiz_png/foPACGrddJ2IMNAbgJ9cv70VpzqEy0tZQIy5xibk1eQf2qeuVQ5CrGh9qx4eaEgBJgjCpLwHYFv42rrG1zeeN7A/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt=""></p>
<p>runLoop:<br><img src="https://mmbiz.qpic.cn/mmbiz_png/foPACGrddJ2IMNAbgJ9cv70VpzqEy0tZMKJLeHV0qVBzSEP7fzuJqfRI8zypEN47ueUSlMDMLVfJUiaBDxBPWxg/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt=""></p>
<p>网络相关<br><img src="https://mmbiz.qpic.cn/mmbiz_png/foPACGrddJ2IMNAbgJ9cv70VpzqEy0tZFo5IB8Vib8ByhQYU2YmzTuCmQQqannO9EgohYbcNwsdxEg53OG8cZnA/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt=""></p>
<p>设置模式：<br><img src="https://mmbiz.qpic.cn/mmbiz_png/foPACGrddJ2IMNAbgJ9cv70VpzqEy0tZVenGEQ2FYtRVmEFvLYS8ibOWIyX5rmz7ujicnTWzMTiabiaILoGcUiaZlNw/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt=""></p>
<p>框架<br><img src="https://mmbiz.qpic.cn/mmbiz_png/foPACGrddJ2IMNAbgJ9cv70VpzqEy0tZ5XhqfMsNU2X4dPMAdtianm3jp4MTFOyzwjML6icv2ohhJb1u9Wm31GXg/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt=""></p>
<p>算法：<br><img src="https://mmbiz.qpic.cn/mmbiz_png/foPACGrddJ2IMNAbgJ9cv70VpzqEy0tZkMfLIbxJsXkMfhLuWlJhQicfWlWWtDaerrQU8ucRzhpotPlrTwLgf0g/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt=""></p>
<p>三方库：<br><img src="https://mmbiz.qpic.cn/mmbiz_png/foPACGrddJ2IMNAbgJ9cv70VpzqEy0tZ79gQx6HQx1SpX03Dicu9lHbgefKuloxoL41GoI9VZSPqqcibUlTuN3Dg/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1" alt=""></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/05/runtime机制/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yida">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="益达的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/05/runtime机制/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-07-05T16:39:57+08:00">
                2018-07-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1.关于底层的属性说明<br>属性和成员变量不同，<br>@property = ivar + getter  + setter；<br>定义的property会在objc_ivar_list中添加一个成员变量的描述，然后再methodList中添加setter和getter方法，objc_property_t是声明的属性类型，是一个指向objc_property结构体指针；</p>
<p>总结：<br>object_property_t * propertyList = class_copyPropertyList(class, &amp;count);<br>foreach就可以查询所有的property的数据信息</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">typedef struct &#123;</span><br><span class="line">    const char * _Nonnull name;           /**<span class="tag">&lt; <span class="attr">The</span> <span class="attr">name</span> <span class="attr">of</span> <span class="attr">the</span> <span class="attr">attribute</span> */</span></span><br><span class="line">    const char * _Nonnull value;          /**&lt; The value of the attribute (usually empty) */</span><br><span class="line">&#125; objc_property_attribute_t;</span><br></pre></td></tr></table></figure>
<p>成员变量<br>Ivar的实例变量类型，是一个指向objc_ivar的结构体的指针<br>typedef struct objc_ivar *ivar;<br>结构体指针的组成如下：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- struct objc_ivar &#123;</span><br><span class="line">    char * _Nullable ivar_name;</span><br><span class="line">    char * _Nullable ivar_type;</span><br><span class="line">    int ivar_offset;基地址的偏移量</span><br><span class="line">#ifdef __LP64__</span><br><span class="line">    int space;</span><br><span class="line">#endif</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>获取整个成员变量列表<br>Ivar <em>class_copyIvarList（Class cls, unsigned int </em>outCount）;<br>我们可以直接通过 ivar_getName(ivar);<br>ivar_getTypeEncoding(ivar);<br>释放指针，<br>注意的一些细节点是：记得释放free(ivars);</p>
<p>定义成员变量的列表；<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">在objc_class中，所有的成员变量，属性的信息是放在链表ivars中的，ivars是一个数组，数组中的每个元素指向Ivar变量指针的地址。</span><br><span class="line">struct objc_ivar_list &#123;</span><br><span class="line">    int ivar_count；</span><br><span class="line">#ifdef __LP64__</span><br><span class="line">    int space；</span><br><span class="line">#endif</span><br><span class="line">    /* variable length structure */</span><br><span class="line">    struct objc_ivar ivar_list[1]；</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>关于存储objc_method的记录<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">struct objc_method &#123;</span><br><span class="line">    SEL _Nonnull method_name;</span><br><span class="line">    char * _Nullable method_types; 存储方法的参数类类和返回值类型</span><br><span class="line">    IMP _Nonnull method_imp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>关于selector的定义，其实底层并没有这个定义；；从相对的总结可以看出，selector其实就是一个char类型的指针；</p>
<p>关于IMP：就是函数指针 ，指向方法实现的首地址<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/// A pointer to the function of a method implementation.</span><br><span class="line">#if !OBJC_OLD_DISPATCH_PROTOTYPES</span><br><span class="line">typedef void (*IMP)(void /* id, SEL, ... */ );</span><br><span class="line">#else</span><br><span class="line">typedef id _Nullable (*IMP)(id _Nonnull, SEL _Nonnull, ...);</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">struct objc_cache &#123;</span><br><span class="line">    unsigned int mask /* total = mask + 1 */  ;</span><br><span class="line">    一个整数，指定分配的缓存bucket的总数。在方法查找过程中，Objective-C runtime使用这个字段来确定开始线性查找数组的索引位置。指向方法selector的指针与该字段做一个AND位操作(index = (mask &amp; selector))。这可以作为一个简单的hash散列算法</span><br><span class="line">    unsigned int occupied;一个整数，指定实际占用的缓存bucket的总数。</span><br><span class="line">    Method _Nullable buckets[1];指向Method数据结构指针的数组。这个数组可能包含不超过mask+1个元素。需要注意的是，指针可能是NULL，表示这个缓存bucket没有被占用，另外被占用的bucket可能是不连续的。这个数组可能会随着时间而增长。</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">objc_protocol_list</span><br><span class="line">struct objc_protocol_list &#123;</span><br><span class="line">    struct objc_protocol_list * _Nullable next;</span><br><span class="line">    long count;</span><br><span class="line">    __unsafe_unretained Protocol * _Nullable list[1];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>方法调用的api<br>方法调用流程<br>检查 selector 是否需要忽略<br>检查 target 是否为 nil，如果是 nil 就直接 cleanup，然后 return<br>在 target 的 Class 中根据 selector 去找 IMP</p>
<p>寻找 IMP 的过程:<br>在当前 class 的方法缓存里寻找（cache methodLists）<br>找到了跳到对应的方法实现，没找到继续往下执行<br>从当前 class 的 方法列表里查找（methodLists），找到了添加到缓存列表里，然后跳转到对应的方法实现；没找到继续往下执行<br>从 superClass 的缓存列表和方法列表里查找，直到找到基类为止<br>以上步骤还找不到 IMP，则进入消息动态处理和消息转发流程</p>
<p>runtime的api的使用：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//获取属性列表</span><br><span class="line">objc_property_t *propertyList = class_copyPropertyList([self class], &amp;count);</span><br><span class="line">//获取方法列表</span><br><span class="line">Method *methodList = class_copyMethodList([self class], &amp;count);</span><br><span class="line">//获取成员列表</span><br><span class="line">Ivar *ivarList = class_copyIvarList([self class], &amp;count);</span><br><span class="line">//获取协议列表</span><br><span class="line">__unsafe_unretained Protocol **protocolList = class_copyProtocolList([self class], &amp;count);</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">动态创建类</span><br><span class="line">Class cls = objc_allocateClassPair(MyClass.class, &quot;MySubClass&quot;, 0);</span><br><span class="line">class_addMethod(cls, @selector(submethod1), (IMP)imp_submethod1, &quot;v@:&quot;);</span><br><span class="line">class_replaceMethod(cls, @selector(method1), (IMP)imp_submethod1, &quot;v@:&quot;);</span><br><span class="line">class_addIvar(cls, &quot;_ivar1&quot;, sizeof(NSString *), log(sizeof(NSString *)), &quot;i&quot;);</span><br><span class="line"></span><br><span class="line">objc_property_attribute_t type = &#123;&quot;T&quot;, &quot;@&quot;NSString&quot;&quot;&#125;;</span><br><span class="line">objc_property_attribute_t ownership = &#123; &quot;C&quot;, &quot;&quot; &#125;;</span><br><span class="line">objc_property_attribute_t backingivar = &#123; &quot;V&quot;, &quot;_ivar1&quot;&#125;;</span><br><span class="line">objc_property_attribute_t attrs[] = &#123;type, ownership, backingivar&#125;;</span><br><span class="line"></span><br><span class="line">class_addProperty(cls, &quot;property2&quot;, attrs, 3);</span><br><span class="line">objc_registerClassPair(cls);</span><br><span class="line"></span><br><span class="line">id instance = [[cls alloc] init];</span><br><span class="line">[instance performSelector:@selector(submethod1)];</span><br><span class="line">[instance performSelector:@selector(method1)];</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">转化关系</span><br><span class="line">id obj = [[NSObject alloc] init];</span><br><span class="line">void *p = (__bridge void *)obj;</span><br><span class="line">id o = (__bridge id)p;</span><br><span class="line"></span><br><span class="line">关于这个转换可以了解更多：ARC 类型转换：显示转换 id 和 void *</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/07/03/+load的底层服务/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yida">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="益达的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/03/+load的底层服务/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-07-03T22:55:28+08:00">
                2018-07-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>关于+load底层的总结</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> Loading isn't really thread safe.</span><br><span class="line"></span><br><span class="line">typedef void(*load_method_t)(id, SEL);</span><br><span class="line"></span><br><span class="line">struct loadable_class &#123;</span><br><span class="line">    Class cls;  // may be nil</span><br><span class="line">    IMP method;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">struct loadable_category &#123;</span><br><span class="line">    Category cat;  // may be nil</span><br><span class="line">    IMP method;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">// List of classes that need +load called (pending superclass +load)</span><br><span class="line">// This list always has superclasses first because of the way it is constructed</span><br><span class="line">static struct loadable_class *loadable_classes = nil;</span><br><span class="line">static int loadable_classes_used = 0;</span><br><span class="line">static int loadable_classes_allocated = 0;</span><br><span class="line"></span><br><span class="line">// List of categories that need +load called (pending parent class +load)</span><br><span class="line">static struct loadable_category *loadable_categories = nil;</span><br><span class="line">static int loadable_categories_used = 0;</span><br><span class="line">static int loadable_categories_allocated = 0;</span><br><span class="line"></span><br><span class="line">提供指定的api来实现</span><br><span class="line">//基于基础类的实现</span><br><span class="line">void add_class_to_loadable_list(Class cls)</span><br><span class="line">//基于类别的实现</span><br><span class="line">void add_category_to_loadable_list(Category cat)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">void call_load_methods(void)</span><br><span class="line">&#123;</span><br><span class="line">    static bool loading = NO;</span><br><span class="line">    bool more_categories;</span><br><span class="line">    loadMethodLock.assertLocked();</span><br><span class="line">    // Re-entrant calls do nothing; the outermost call will finish the job.</span><br><span class="line">    if (loading) return;</span><br><span class="line">    loading = YES;</span><br><span class="line">    void *pool = objc_autoreleasePoolPush();</span><br><span class="line">    do &#123;</span><br><span class="line">        // 1. Repeatedly call class +loads until there aren't any more</span><br><span class="line">        while (loadable_classes_used &gt; 0) &#123;</span><br><span class="line">            call_class_loads();</span><br><span class="line">        &#125;</span><br><span class="line">        // 2. Call category +loads ONCE</span><br><span class="line">        more_categories = call_category_loads();</span><br><span class="line">        // 3. Run more +loads if there are classes OR more untried categories</span><br><span class="line">    &#125; while (loadable_classes_used &gt; 0  ||  more_categories);</span><br><span class="line">    objc_autoreleasePoolPop(pool);</span><br><span class="line">    loading = NO;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/06/21/Vue/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yida">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="益达的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/21/Vue/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-06-21T19:37:13+08:00">
                2018-06-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>前端如何实现vue-router的使用和原理；</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/10/javaScriptCore的说明/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yida">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="益达的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/10/javaScriptCore的说明/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-10T09:50:08+08:00">
                2018-05-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>关于javaScriptCore</p>
<p>JSContext是JS代码的执行环境<br>JSContext为JS代码的执行提供了上下文环境，通过JSCore执行的js代码都得通过JSContext来执行</p>
<p>JSContext对应于一个JS中的全局对象</p>
<p>JSValue是对JS值的包装，JS值到OC中不能直接使用，JSValue就是对JS值的包装，<br><img src="https://upload-images.jianshu.io/upload_images/762048-c669c91024c9308b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/491" alt=""></p>
<p>JSValue存在于JSValue是不能独立存在的，它必须被存在某一个Context中，JSValue对应的JS值和其所属的JSContext的对象都是强弱引用的关系。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">context[@"makeNSColor"] = ^(NSDictionary *rgb)&#123;</span><br><span class="line">       float r = [rgb[@"red"] floatValue];</span><br><span class="line">       float g = [rgb[@"green"] floatValue];</span><br><span class="line">       float b = [rgb[@"blue"] floatValue];</span><br><span class="line">       return [UIColor</span><br><span class="line">               colorWithRed:(r/255.f)</span><br><span class="line">               green:(g/255.f) blue:(b/255.f)</span><br><span class="line">               alpha:1.0];</span><br><span class="line">   &#125;;</span><br><span class="line">   JSValue *value1 = [context evaluateScript:@"makeNSColor(&#123;red:12,green:23,blue:67&#125;)"];</span><br></pre></td></tr></table></figure>
<p>使用Block暴露方法很方便，但是有2个坑需要注意一下：</p>
<p>1.不要在Block中直接使用JSValue<br>2.不要在Block中直接使用JSContext</p>
<p>因为Block会强引用它里面用到的外部变量，如果直接在Block中使用JSValue的话，那么这个JSvalue就会被这个Block强引用，而每个JSValue都是强引用着它所属的那个JSContext的，这是前面说过的，而这个Block又是注入到这个Context中，所以这个Block会被context强引用，这样会造成循环引用，导致内存泄露。不能直接使用JSContext的原因同理。</p>
<p>针对第一点，建议把JSValue当做参数传到Block中，而不是直接在Block内部使用，这样Block就不会强引用JSValue了。</p>
<p>针对第二点，可以使用[JSContext currentContext] 方法来获取当前的Context。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@protocol MyPointExports <span class="tag">&lt;<span class="name">JSExport</span>&gt;</span></span><br><span class="line"></span><br><span class="line">声明一个自定义的协议并继承自JSExport协议。然后当你把实现这个自定义协议的对象暴露给JS时，JS就能像使用原生对象一样使用OC对象了，也就是前面说的API目标之高保真。</span><br></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/762048-3ae18cd8c1e4bdfc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/497" alt=""></p>
<p>当你声明一个继承自JSExport的自定义协议时，就是在告诉JSCore，这个自定义协议中声明的属性，实例方法和类方法需要被暴露给JS使用。（不在这个协议中的方法不会被暴露出去。）</p>
<p>当你把实现这个协议的类的对象暴露给JS时，JS中会生成一个对应的JS对象，然后，JSCore会按照这个协议中声明的内容，去遍历实现这个协议的类，把协议中声明的属性，转换成JS 对象中的属性，实质上是转换成getter 和 setter 方法，转换方法和之前说的block类似，创建一个JS方法包装着OC中的方法，然后协议中声明的实例方法，转换成JS对象上的实例方法，类方法转换成JS中某个全局对象上的方法。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/762048-be5d18cdb7bb7df5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/599" alt=""></p>
<p>我们有一个MyPoint类的对象point，当我们用JSExport协议将这个OC对象暴露给JS时，JSCore首先会在JS上下文环境中为该类生成一个对应的原型对象和构造函数，然后JSCore会扫描这个类，把其中在JSExport协议中声明的内容暴露给JS，属性(即getter和setter方法)会被添加到原型对象上，而类方法会被添加到到这个构造函数上，这个放的位置，就正好对应了OC中的类和元类。</p>
<p>不要在JS中给OC对象增加成员变量，这句话的意思就是说，当我们将一个OC对象暴露给JS后，就像前面说的使用JSExport协议，我们能想操纵JS对象一样操纵OC对象，但是这时候，不要在JS中给这个OC对象添加成员变量，因为这个动作产生的后果就是，只会在JS中为这个OC对象增加一个额外的成员变量，但是OC中并不会同步增加。所以说这样做并没有什么意义，还有可能造成一些奇怪的内存管理问题。</p>
<p>OC对象不要直接强引用JSValue对象，这句话再说直白点，就是不要直接将一个JSValue类型的对象当成属性或者成员变量保存在一个OC对象中，尤其是这个OC对象还暴露给JS的时候。这样会造成循环引用。</p>
<p>用JSManagedValue来解决强引用的问题：<br>，用JSValue创建一个JSManagedValue对象，JSManagedValue里面其实就是包着一个JSValue对象，可以通过它里面一个只读的value属性取到，这一步其实是添加一个对JSValue的弱引用。</p>
<p>说多线程之前得先说下另一个类 JSVirtualMachine, 它为JavaScript的运行提供了底层资源，有自己独立的堆栈以及垃圾回收机制。</p>
<p>JSVirtualMachine还是JSContext的容器，可以包含若干个JSContext，在一个进程中，你可以有多个JSVirtualMachine，里面包含着若干个JSContext，而JSContext中又有若干个JSValue，他们的包含关系如下图：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/762048-8b482ac389babfc2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/700" alt=""></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/06/shell高阶预发的使用说明/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yida">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="益达的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/06/shell高阶预发的使用说明/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-06T16:23:30+08:00">
                2018-05-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>join的语法集合：</p>
<p>join fileone filetwo 根据文件的第一个域空间进行数据merge</p>
<p>join -1 2 -2 3 fileone filetwo 根据文件的指定域空间 进行数据merge</p>
<p>关于 awk的使用：</p>
<p>awk ‘{[pattern] action}’ {filenames}</p>
<p>awk ‘{print $1,$4}’ log.txt  没行按照tab分割</p>
<p>awk -F  #-F相当于内置变量FS, 指定分割字符</p>
<p>awk -F, ‘{print $1,$2}’   log.txt 按照，分割</p>
<p>awk -F ‘[ ,]’  ‘{print $1,$2,$5}’   log.txt 背景</p>
<p>who | awk ‘{print $1}’ | sort -u</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/05/03/语法的权限测试/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="yida">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="益达的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/03/语法的权限测试/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-05-03T22:59:58+08:00">
                2018-05-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>join的语法集合：</p>
<p>join fileone filetwo 根据文件的第一个域空间进行数据merge</p>
<p>join -1 2 -2 3 fileone filetwo 根据文件的指定域空间 进行数据merge</p>
<p>关于 awk的使用：</p>
<p>awk ‘{[pattern] action}’ {filenames}</p>
<p>awk ‘{print $1,$4}’ log.txt  没行按照tab分割</p>
<p>awk -F  #-F相当于内置变量FS, 指定分割字符</p>
<p>awk -F, ‘{print $1,$2}’   log.txt 按照，分割</p>
<p>awk -F ‘[ ,]’  ‘{print $1,$2,$5}’   log.txt 背景</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">yida</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">47</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">yida</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
